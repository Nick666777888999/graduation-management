<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>畢業資料管理系統</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { box-sizing: border-box; }
    body { 
      margin: 0; 
      font-family: "Microsoft JhengHei", "Segoe UI", sans-serif; 
      background-color: #f0f8ff;
    }
    
    /* 頂部導航欄 */
    .top-bar { 
      background: linear-gradient(135deg, #008B8B, #20B2AA); 
      color: white; 
      padding: 12px 20px; 
      display: flex; 
      justify-content: space-between; 
      align-items: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
    }
    
    .top-bar .title {
      font-size: 1.4rem;
      font-weight: bold;
    }
    
    .top-bar .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .top-bar .admin-badge {
      background: #ff9800;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: bold;
    }
    
    .top-bar .admin-tools {
      position: relative;
    }
    
    .admin-menu {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
      min-width: 200px;
      display: none;
      z-index: 1001;
    }
    
    .admin-menu.show {
      display: block;
    }
    
    .admin-menu-item {
      padding: 12px 15px;
      cursor: pointer;
      border-bottom: 1px solid #eee;
      color: #333;
      transition: background 0.3s;
    }
    
    .admin-menu-item:hover {
      background: #f5f5f5;
    }
    
    .admin-menu-item i {
      margin-right: 8px;
      width: 20px;
      text-align: center;
    }
    
    /* 側邊欄 - 響應式設計 */
    .side-bar { 
      background: linear-gradient(to bottom, #008B8B, #20B2AA); 
      width: 250px; 
      height: 100vh; 
      position: fixed; 
      top: 0; 
      left: 0; 
      padding-top: 70px; 
      color: white; 
      box-shadow: 2px 0 10px rgba(0,0,0,0.1);
      z-index: 999;
      transition: all 0.3s ease;
      overflow-y: auto;
    }
    
    .side-bar button { 
      display: flex; 
      align-items: center;
      width: 100%; 
      background: none; 
      border: none; 
      color: white; 
      padding: 15px 20px; 
      text-align: left; 
      cursor: pointer; 
      font-size: 16px;
      transition: all 0.3s;
      border-left: 4px solid transparent;
    }
    
    .side-bar button i {
      margin-right: 12px;
      width: 20px;
      text-align: center;
      font-size: 18px;
    }
    
    .side-bar button:hover { 
      background-color: rgba(255,255,255,0.1); 
      border-left: 4px solid #ffeb3b;
    }
    
    .side-bar button.active {
      background-color: rgba(255,255,255,0.15);
      border-left: 4px solid #ffeb3b;
    }
    
    /* 主內容區域 */
    .content { 
      margin-left: 250px; 
      padding: 80px 30px 30px; 
      background-color: #f5f5f5; 
      min-height: 100vh; 
      transition: margin-left 0.3s ease;
    }
    
    .content-card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      padding: 25px;
      margin-bottom: 25px;
    }
    
    .content-card h2 {
      color: #008B8B;
      margin-top: 0;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 10px;
    }
    
    /* 公告樣式 */
    .announcement { 
      background: white; 
      margin-bottom: 20px; 
      padding: 20px; 
      border-left: 5px solid #008B8B; 
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      position: relative;
    }
    
    .announcement h3 { 
      margin-top: 0; 
      color: #008B8B;
    }
    
    .announcement-actions {
      position: absolute;
      top: 15px;
      right: 15px;
    }
    
    .delete-announcement {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }
    
    .delete-announcement:hover {
      background: #c0392b;
    }
    
    /* 登入/註冊頁面 */
    .login-wrapper { 
      display: flex; 
      justify-content: center; 
      align-items: center; 
      height: 100vh; 
      background: linear-gradient(135deg, #008B8B, #20B2AA);
    }
    
    .login-box, .register-box, .admin-login-box { 
      background: white; 
      padding: 30px; 
      border-radius: 15px; 
      width: 380px; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    
    .login-box h2, .register-box h2, .admin-login-box h2 {
      text-align: center;
      color: #008B8B;
      margin-top: 0;
    }
    
    .login-box input, .register-box input, .admin-login-box input { 
      width: 100%; 
      padding: 12px 15px; 
      margin: 10px 0; 
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      transition: border 0.3s;
    }
    
    .login-box input:focus, .register-box input:focus, .admin-login-box input:focus {
      border-color: #008B8B;
      outline: none;
      box-shadow: 0 0 0 2px rgba(0,139,139,0.2);
    }
    
    .login-box button, .register-box button, .admin-login-box button { 
      width: 100%; 
      padding: 12px; 
      background: linear-gradient(to right, #008B8B, #20B2AA); 
      color: white; 
      border: none; 
      border-radius: 8px;
      cursor: pointer; 
      margin-top: 10px; 
      font-size: 16px;
      font-weight: bold;
      transition: all 0.3s;
    }
    
    .login-box button:hover, .register-box button:hover, .admin-login-box button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,139,139,0.3);
    }
    
    .error { 
      color: #e74c3c; 
      text-align: center; 
      margin: 10px 0;
      font-weight: bold;
    }
    
    /* 聊天室樣式 - 修改為Line風格 */
    .chat-message { 
      background: white; 
      padding: 15px; 
      margin: 15px 0; 
      border-radius: 12px; 
      position: relative;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      max-width: 70%;
      word-wrap: break-word;
    }
    
    .chat-message.own {
      background: #dcf8c6;
      margin-left: auto;
      border-bottom-right-radius: 5px;
    }
    
    .chat-message.other {
      background: white;
      margin-right: auto;
      border-bottom-left-radius: 5px;
    }
    
    .chat-message.admin {
      border-left: 5px solid #ff9800;
      background: #fff9e6;
      max-width: 90%;
      margin: 15px auto;
    }
    
    .chat-message .time { 
      font-size: 12px; 
      color: #888; 
      text-align: right; 
      margin-top: 5px;
    }
    
    .chat-message .sender-name {
      font-weight: bold;
      color: #008B8B;
      margin-bottom: 5px;
      font-size: 14px;
    }
    
    .chat-media {
      max-width: 100%;
      max-height: 300px;
      border-radius: 8px;
      margin: 10px 0;
    }
    
    .chat-input { 
      display: flex; 
      margin-top: 15px; 
      gap: 10px;
    }
    
    .chat-input input { 
      flex: 1; 
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
    }
    
    .chat-input button { 
      padding: 12px 20px; 
      background: linear-gradient(to right, #008B8B, #20B2AA); 
      color: white; 
      border: none; 
      border-radius: 8px;
      cursor: pointer; 
      font-weight: bold;
      transition: all 0.3s;
    }
    
    .chat-input button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,139,139,0.3);
    }
    
    .media-upload-btn {
      background: #9b59b6 !important;
    }
    
    .avatar { 
      width: 40px; 
      height: 40px; 
      border-radius: 50%; 
      object-fit: cover; 
      margin-right: 10px;
      border: 2px solid #008B8B;
    }
    
    /* 資料表格樣式 */
    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    
    .data-table th, .data-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    
    .data-table th {
      background-color: #f5f5f5;
      color: #008B8B;
      font-weight: bold;
    }
    
    .data-table tr:hover {
      background-color: #f9f9f9;
    }
    
    .delete-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .delete-btn:hover {
      background: #c0392b;
    }
    
    /* 響應式設計 */
    @media (max-width: 1200px) {
      .side-bar {
        width: 220px;
      }
      .content {
        margin-left: 220px;
      }
    }
    
    @media (max-width: 992px) {
      .side-bar {
        width: 200px;
      }
      .content {
        margin-left: 200px;
        padding: 70px 20px 20px;
      }
    }
    
    @media (max-width: 768px) {
      .side-bar {
        width: 70px;
      }
      
      .side-bar button span {
        display: none;
      }
      
      .side-bar button i {
        margin-right: 0;
        font-size: 20px;
      }
      
      .content {
        margin-left: 70px;
        padding: 70px 15px 15px;
      }
      
      .login-box, .register-box, .admin-login-box {
        width: 90%;
        max-width: 350px;
      }
      
      .chat-message {
        max-width: 85%;
      }
    }
    
    @media (max-width: 576px) {
      .side-bar {
        width: 60px;
      }
      
      .content {
        margin-left: 60px;
        padding: 70px 10px 10px;
      }
      
      .top-bar .title {
        font-size: 1.1rem;
      }
      
      .top-bar .user-info {
        font-size: 0.9rem;
      }
    }
    
    /* 統計卡片 */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 25px;
    }
    
    .stat-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }
    
    .stat-card i {
      font-size: 2.5rem;
      color: #008B8B;
      margin-bottom: 10px;
    }
    
    .stat-card .number {
      font-size: 2rem;
      font-weight: bold;
      color: #008B8B;
    }
    
    .stat-card .label {
      color: #666;
      margin-top: 5px;
    }
    
    /* 表單樣式 */
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555;
    }
    
    .form-control {
      width: 100%;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
    }
    
    .form-control:focus {
      border-color: #008B8B;
      outline: none;
      box-shadow: 0 0 0 2px rgba(0,139,139,0.2);
    }
    
    .checkbox-group {
      display: flex;
      align-items: center;
      margin: 15px 0;
    }
    
    .checkbox-group input {
      margin-right: 10px;
    }
    
    /* 通知樣式 */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 20px;
      border-radius: 8px;
      color: white;
      font-weight: bold;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      z-index: 1100;
      transform: translateX(150%);
      transition: transform 0.4s;
    }
    
    .notification.show {
      transform: translateX(0);
    }
    
    .notification.success {
      background: #2ecc71;
    }
    
    .notification.error {
      background: #e74c3c;
    }
    
    .notification.info {
      background: #3498db;
    }
    
    /* 個人簡介彈窗 */
    .profile-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }
    
    .profile-modal-content {
      background: white;
      border-radius: 15px;
      width: 500px;
      max-width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    
    .profile-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      border-bottom: 1px solid #eee;
      padding-bottom: 15px;
    }
    
    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 20px;
      border: 3px solid #008B8B;
    }
    
    .profile-info h3 {
      margin: 0 0 5px 0;
      color: #008B8B;
    }
    
    .profile-info p {
      margin: 0;
      color: #666;
    }
    
    .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #888;
    }
    
    .close-modal:hover {
      color: #333;
    }
    
    /* 個人介紹區域 */
    .personal-intro {
      background: #f9f9f9;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      border-left: 4px solid #008B8B;
    }
    
    .personal-intro h4 {
      margin-top: 0;
      color: #008B8B;
    }
    
    .intro-text {
      white-space: pre-line;
      line-height: 1.5;
    }
    
    .edit-intro-btn {
      background: #008B8B;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }
    
    .edit-intro-btn:hover {
      background: #006666;
    }
    
    /* 搜尋區域 */
    .search-box {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .search-form {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .search-form .form-group {
      flex: 1;
      min-width: 200px;
      margin-bottom: 0;
    }
    
    .search-btn {
      background: #008B8B;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    
    .search-btn:hover {
      background: #006666;
    }
    
    /* 機器人驗證 */
    .captcha-box {
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
    }
    
    .captcha-checkbox {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      cursor: pointer;
    }
    
    .captcha-checkbox input {
      width: 20px;
      height: 20px;
    }

    /* 學生資料卡片樣式 */
    .student-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      padding: 20px;
      margin-bottom: 20px;
      border-left: 5px solid #008B8B;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .student-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .student-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      border-bottom: 1px solid #eee;
      padding-bottom: 15px;
    }

    .student-avatar {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 20px;
      border: 3px solid #008B8B;
    }

    .student-basic-info h3 {
      margin: 0 0 5px 0;
      color: #008B8B;
      font-size: 1.3rem;
    }

    .student-basic-info p {
      margin: 2px 0;
      color: #666;
      font-size: 0.9rem;
    }

    .student-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .detail-group {
      background: #f8f9fa;
      padding: 12px;
      border-radius: 8px;
      border-left: 3px solid #20B2AA;
    }

    .detail-group h4 {
      margin: 0 0 8px 0;
      color: #008B8B;
      font-size: 0.95rem;
    }

    .detail-group p {
      margin: 0;
      color: #555;
      line-height: 1.4;
    }

    .student-intro {
      background: #e8f4f8;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      border-left: 3px solid #3498db;
    }

    .student-intro h4 {
      margin: 0 0 8px 0;
      color: #2980b9;
    }

    .student-intro p {
      margin: 0;
      color: #2c3e50;
      line-height: 1.5;
    }

    .student-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      justify-content: flex-end;
    }

    .approve-btn {
      background: #2ecc71;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }

    .approve-btn:hover {
      background: #27ae60;
    }

    .reject-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }

    .reject-btn:hover {
      background: #c0392b;
    }

    .status-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: bold;
      margin-left: 10px;
    }

    .status-pending {
      background: #f39c12;
      color: white;
    }

    .status-approved {
      background: #2ecc71;
      color: white;
    }

    .status-rejected {
      background: #e74c3c;
      color: white;
    }

    /* 字數計數器 */
    .char-counter {
      text-align: right;
      font-size: 0.8rem;
      color: #666;
      margin-top: 5px;
    }

    .char-counter.warning {
      color: #e74c3c;
    }

    /* 審核頁面樣式 */
    .filter-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      border-bottom: 1px solid #eee;
      padding-bottom: 15px;
    }

    .filter-tab {
      background: #f5f5f5;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .filter-tab.active {
      background: #008B8B;
      color: white;
    }

    .filter-tab:hover {
      background: #20B2AA;
      color: white;
    }

    /* 好友系統樣式 - Instagram風格 */
    .friend-section {
      margin-bottom: 25px;
    }

    .friend-section-title {
      background: linear-gradient(135deg, #008B8B, #20B2AA);
      color: white;
      padding: 12px 20px;
      border-radius: 10px 10px 0 0;
      margin-bottom: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .friend-container {
      background: white;
      border-radius: 0 0 10px 10px;
      padding: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    }

    .friend-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }

    .friend-card {
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 15px;
      padding: 20px;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .friend-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      border-color: #008B8B;
    }

    .friend-card.online::before {
      content: '';
      position: absolute;
      top: 15px;
      right: 15px;
      width: 12px;
      height: 12px;
      background: #2ecc71;
      border-radius: 50%;
      border: 2px solid white;
    }

    .friend-card.offline::before {
      content: '';
      position: absolute;
      top: 15px;
      right: 15px;
      width: 12px;
      height: 12px;
      background: #95a5a6;
      border-radius: 50%;
      border: 2px solid white;
    }

    .friend-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }

    .friend-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 20px;
      border: 3px solid #008B8B;
    }

    .friend-info h4 {
      margin: 0 0 8px 0;
      color: #2c3e50;
      font-size: 1.2rem;
    }

    .friend-info p {
      margin: 0;
      color: #7f8c8d;
      font-size: 0.95rem;
    }

    .friend-stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      font-size: 0.85rem;
      color: #666;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 8px;
    }

    .friend-actions {
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
    }

    .friend-action-btn {
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .friend-action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
    }

    .friend-action-btn.chat {
      background: #2ecc71;
    }

    .friend-action-btn.remove {
      background: #e74c3c;
    }

    /* 好友申請卡片 */
    .friend-request-card {
      background: linear-gradient(135deg, #fff3cd, #ffeaa7);
      border: 2px solid #ffd43b;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 15px;
    }

    .request-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    /* 私訊聊天室樣式 */
    .private-chat-container {
      max-height: 500px;
      overflow-y: auto;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      background: #f9f9f9;
    }

    .private-message {
      background: white;
      padding: 12px 16px;
      margin: 8px 0;
      border-radius: 18px;
      max-width: 70%;
      word-wrap: break-word;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .private-message.own {
      background: #dcf8c6;
      margin-left: auto;
      border-bottom-right-radius: 5px;
    }

    .private-message.other {
      background: white;
      margin-right: auto;
      border-bottom-left-radius: 5px;
    }

    .private-message .time {
      font-size: 11px;
      opacity: 0.7;
      margin-top: 5px;
      text-align: right;
    }

    .private-message .sender {
      font-weight: bold;
      color: #008B8B;
      margin-bottom: 5px;
      font-size: 13px;
    }

    /* 題目討論區樣式 */
    .question-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      padding: 20px;
      margin-bottom: 20px;
      border-left: 5px solid #3498db;
    }

    .question-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }

    .question-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 15px;
    }

    .question-meta h4 {
      margin: 0 0 5px 0;
      color: #2c3e50;
    }

    .question-meta .grade-subject {
      color: #7f8c8d;
      font-size: 0.9rem;
    }

    .question-content {
      margin-bottom: 15px;
    }

    .question-text {
      line-height: 1.6;
      margin-bottom: 15px;
    }

    .question-image {
      max-width: 100%;
      max-height: 400px;
      border-radius: 8px;
      margin-bottom: 15px;
    }

    .question-actions {
      display: flex;
      gap: 15px;
      border-top: 1px solid #eee;
      padding-top: 15px;
    }

    .action-btn {
      background: none;
      border: none;
      color: #666;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: color 0.3s;
    }

    .action-btn:hover {
      color: #008B8B;
    }

    .action-btn.liked {
      color: #e74c3c;
    }

    .comments-section {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #eee;
    }

    .comment {
      background: #f8f9fa;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .comment-header {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
    }

    .comment-avatar {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 10px;
    }

    .comment-content {
      margin-left: 40px;
    }

    .add-comment {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .add-comment input {
      flex: 1;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 20px;
    }

    /* 發表題目浮動按鈕 */
    .floating-action-btn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #008B8B, #20B2AA);
      color: white;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      z-index: 1000;
      transition: all 0.3s;
    }

    .floating-action-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 25px rgba(0,0,0,0.4);
    }

    /* 發表題目表單 */
    .question-form-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }

    .question-form-content {
      background: white;
      border-radius: 15px;
      width: 600px;
      max-width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }

    .subject-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 10px 0;
    }

    .subject-tag {
      background: #e8f4f8;
      border: 1px solid #3498db;
      border-radius: 15px;
      padding: 5px 12px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s;
    }

    .subject-tag:hover {
      background: #3498db;
      color: white;
    }

    .subject-tag.selected {
      background: #3498db;
      color: white;
    }

    /* 空狀態 */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #7f8c8d;
    }

    .empty-state i {
      font-size: 3rem;
      margin-bottom: 15px;
      color: #bdc3c7;
    }

    .empty-state h3 {
      margin: 0 0 10px 0;
      color: #95a5a6;
    }
  </style>
</head>
<body>
  <!-- 登入頁面 -->
  <div class="login-wrapper" id="login-screen">
    <div class="login-box">
      <h2><i class="fas fa-graduation-cap"></i> 畢業資料管理系統</h2>
      <div class="error" id="error-msg"></div>
      <input type="text" id="username" placeholder="帳號">
      <input type="password" id="password" placeholder="密碼">
      <button onclick="alert("功能修復中")"><i class="fas fa-sign-in-alt"></i> 登入</button>
      <button onclick="alert("功能修復中")"><i class="fas fa-user-plus"></i> 註冊</button>
      <button onclick="alert("功能修復中")" style="background: #ff9800;"><i class="fas fa-user-shield"></i> 管理員登入</button>
    </div>
  </div>

  <!-- 管理員登入頁面 -->
  <div class="login-wrapper" id="admin-login-screen" style="display:none;">
    <div class="admin-login-box">
      <h2><i class="fas fa-user-shield"></i> 管理員登入</h2>
      <div class="error" id="admin-error-msg"></div>
      <input type="text" id="admin-username" placeholder="管理員帳號">
      <input type="password" id="admin-password" placeholder="管理員密碼">
      
      <div class="captcha-box">
        <div class="captcha-checkbox" onclick="toggleCaptcha()">
          <input type="checkbox" id="captcha-check">
          <label for="captcha-check">我不是機器人</label>
        </div>
      </div>
      
      <button onclick="adminLogin()"><i class="fas fa-sign-in-alt"></i> 管理員登入</button>
      <button onclick="hideAdminLogin()"><i class="fas fa-arrow-left"></i> 返回</button>
    </div>
  </div>

  <!-- 註冊頁面 -->
  <div class="login-wrapper" id="register-screen" style="display:none;">
    <div class="register-box">
      <h2><i class="fas fa-user-plus"></i> 註冊帳號</h2>
      <input type="text" id="reg-name" placeholder="姓名">
      <input type="text" id="reg-school" placeholder="就讀學校">
      <input type="email" id="reg-email" placeholder="Gmail">
      <input type="text" id="reg-username" placeholder="帳號">
      <input type="password" id="reg-password" placeholder="密碼">
      <textarea id="reg-intro" placeholder="個人介紹 (至少50字)" class="form-control" rows="3" oninput="countChars('reg-intro', 'reg-char-count')"></textarea>
      <div id="reg-char-count" class="char-counter">0/50</div>
      <button onclick="register()"><i class="fas fa-check"></i> 送出</button>
      <button onclick="hideRegister()"><i class="fas fa-arrow-left"></i> 返回</button>
    </div>
  </div>

  <!-- 主系統頁面 -->
  <div id="main-screen" style="display:none;">
    <div class="top-bar">
      <div class="title"><i class="fas fa-graduation-cap"></i> 畢業資料管理系統</div>
      <div class="user-info">
        <span id="current-user-name">使用者</span>
        <span id="admin-badge" class="admin-badge" style="display:none;">管理員</span>
        <span onclick="showProfileModal()" style="cursor:pointer;"><i class="fas fa-user-circle"></i> 個人簡介</span>
        <div class="admin-tools" id="admin-tools" style="display:none;">
          <span onclick="toggleAdminMenu()" style="cursor:pointer;"><i class="fas fa-cog"></i> 管理工具</span>
          <div class="admin-menu" id="admin-menu">
            <div class="admin-menu-item" onclick="openSystemEditor()">
              <i class="fas fa-code"></i> 系統編輯器
            </div>
            <div class="admin-menu-item" onclick="loadContent('system_config')">
              <i class="fas fa-cogs"></i> 系統設定
            </div>
            <div class="admin-menu-item" onclick="backupSystem()">
              <i class="fas fa-download"></i> 備份系統
            </div>
            <div class="admin-menu-item" onclick="restoreSystem()">
              <i class="fas fa-upload"></i> 還原系統
            </div>
          </div>
        </div>
        <span onclick="logout()" style="cursor:pointer; margin-left:15px;"><i class="fas fa-sign-out-alt"></i> 登出</span>
      </div>
    </div>
    <div class="side-bar">
      <button onclick="loadContent('dashboard')" class="active"><i class="fas fa-tachometer-alt"></i> <span>儀表板</span></button>
      <button onclick="loadContent('announcements')"><i class="fas fa-bullhorn"></i> <span>系統公告</span></button>
      <button onclick="loadContent('primary')"><i class="fas fa-child"></i> <span>國小學生</span></button>
      <button onclick="loadContent('junior')"><i class="fas fa-user-graduate"></i> <span>國中學生</span></button>
      <button onclick="loadContent('high')"><i class="fas fa-user-tie"></i> <span>高中學生</span></button>
      <button onclick="loadContent('data-entry')"><i class="fas fa-edit"></i> <span>資料填寫</span></button>
      <button onclick="loadContent('other')"><i class="fas fa-users"></i> <span>其他年級</span></button>
      <button onclick="loadContent('search')"><i class="fas fa-search"></i> <span>資料查詢</span></button>
      <button onclick="loadContent('review')" id="review-btn" style="display:none;"><i class="fas fa-clipboard-check"></i> <span>資料審核</span></button>
      <button onclick="loadContent('statistics')" id="statistics-btn" style="display:none;"><i class="fas fa-chart-bar"></i> <span>數據統計</span></button>
      <button onclick="loadContent('chat')"><i class="fas fa-comments"></i> <span>八卦聊天室</span></button>
      <button onclick="loadContent('questions')"><i class="fas fa-question-circle"></i> <span>題目討論區</span></button>
      <button onclick="loadContent('friends')"><i class="fas fa-user-friends"></i> <span>好友系統</span></button>
    </div>
    <div class="content" id="content-area">
      <!-- 內容將由JavaScript動態載入 -->
    </div>
  </div>

  <!-- 個人簡介彈窗 -->
  <div id="profile-modal" class="profile-modal">
    <div class="profile-modal-content">
      <button class="close-modal" onclick="closeProfileModal()">&times;</button>
      <div class="profile-header">
        <img id="profile-avatar" src="https://ui-avatars.com/api/?name=使用者&background=008B8B&color=fff" class="profile-avatar">
        <div class="profile-info">
          <h3 id="profile-name">使用者名稱</h3>
          <p id="profile-school">學校名稱</p>
          <p id="profile-email">email@example.com</p>
        </div>
      </div>
      
      <div class="form-group">
        <label>個人介紹 (至少50字)</label>
        <textarea id="profile-intro" class="form-control" rows="4" placeholder="請輸入您的個人介紹..." oninput="countChars('profile-intro', 'profile-char-count')"></textarea>
        <div id="profile-char-count" class="char-counter">0/50</div>
      </div>
      
      <div class="form-group">
        <label>匿名顯示名稱 (聊天室使用)</label>
        <input type="text" id="profile-anonymous" class="form-control" placeholder="輸入匿名顯示名稱">
      </div>
      
      <div class="form-group">
        <label>個性特質</label>
        <input type="text" id="profile-personality" class="form-control" placeholder="例如：活潑開朗、細心負責">
      </div>
      
      <div class="form-group">
        <label>興趣愛好</label>
        <input type="text" id="profile-hobbies" class="form-control" placeholder="例如：閱讀、運動、音樂">
      </div>
      
      <div class="form-group">
        <label>喜歡的事物</label>
        <input type="text" id="profile-likes" class="form-control" placeholder="例如：貓咪、旅行、美食">
      </div>
      
      <div class="form-group">
        <label>上傳頭像</label>
        <input type="file" id="avatar-upload" class="form-control" accept="image/*">
      </div>
      
      <div class="form-group">
        <label>變更密碼</label>
        <input type="password" id="profile-current-password" class="form-control" placeholder="當前密碼">
        <input type="password" id="profile-new-password" class="form-control" placeholder="新密碼">
        <input type="password" id="profile-confirm-password" class="form-control" placeholder="確認新密碼">
      </div>
      
      <button onclick="updateProfile()" class="login-box button" style="width:100%;"><i class="fas fa-save"></i> 儲存變更</button>
    </div>
  </div>

  <!-- 發表題目表單 -->
  <div id="question-form-modal" class="question-form-modal">
    <div class="question-form-content">
      <button class="close-modal" onclick="closeQuestionForm()">&times;</button>
      <h2><i class="fas fa-question-circle"></i> 發表問題</h2>
      
      <div class="form-group">
        <label>請發表你不會的問題 (0-150字)</label>
        <textarea id="question-text" class="form-control" rows="4" placeholder="請詳細描述您的問題..." maxlength="150" oninput="countChars('question-text', 'question-char-count')"></textarea>
        <div id="question-char-count" class="char-counter">0/150</div>
      </div>
      
      <div class="form-group">
        <label>添加照片 (選填)</label>
        <input type="file" id="question-image" class="form-control" accept="image/*">
      </div>
      
      <div class="form-group">
        <label>科目</label>
        <div class="subject-tags" id="subject-tags">
          <span class="subject-tag" data-subject="國文">國文</span>
          <span class="subject-tag" data-subject="成語">成語</span>
          <span class="subject-tag" data-subject="作文">作文</span>
          <span class="subject-tag" data-subject="英文">英文</span>
          <span class="subject-tag" data-subject="數學">數學</span>
          <span class="subject-tag" data-subject="社會">社會</span>
          <span class="subject-tag" data-subject="歷史">歷史</span>
          <span class="subject-tag" data-subject="地理">地理</span>
          <span class="subject-tag" data-subject="生物">生物</span>
          <span class="subject-tag" data-subject="化學">化學</span>
          <span class="subject-tag" data-subject="物理">物理</span>
          <span class="subject-tag" data-subject="其他科目">其他科目</span>
        </div>
        <input type="text" id="selected-subject" class="form-control" placeholder="選擇科目" readonly>
      </div>
      
      <div class="form-group">
        <label>年級</label>
        <input type="text" id="question-grade" class="form-control" placeholder="例如：六年級、國二、高三">
      </div>
      
      <button onclick="submitQuestion()" class="login-box button" style="width:100%;"><i class="fas fa-paper-plane"></i> 發表問題</button>
    </div>
  </div>

  <!-- 發表題目浮動按鈕 -->
  <button id="floating-action-btn" class="floating-action-btn" style="display:none;" onclick="openQuestionForm()">
    <i class="fas fa-plus"></i>
  </button>

  <!-- 通知區域 -->
  <div id="notification" class="notification"></div>

  <script>
    // 全域變數
    let currentUser = null;
    let isAdmin = false;
    let currentPage = 'dashboard';
    let captchaVerified = false;
    
    // 實時更新相關變數
    let updateInterval = null;
    let lastUpdateCheck = 0;
    let isCheckingUpdates = false;

    // 後端數據（從 API 獲取）
    // 後端數據（混合方案：先從 API 加載，失敗則用 localStorage）
    // 後端數據（使用 localStorage）
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 從 API 加載數據，失敗時使用 localStorage
        // 先嘗試從 API 加載
        const response = fetch('/api/sync_data');
        if (response.ok) {
          const result = response.json();
          if (result.success) {
            backendData = result.data;
            console.log('從 API 加載數據成功');
            return;
          }
        }
      } catch (error) {
        console.log('API 加載失敗，使用 localStorage:', error);
      }
      
      // API 失敗時使用 localStorage
      backendData = {
        users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
        studentData: {
          primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
          junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
          high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
          other: JSON.parse(localStorage.getItem('backend_other') || '[]')
        },
        pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
        announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
        systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
        friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
        privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
        questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
        chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
      };
    }

    // 保存數據：同時保存到 API 和 localStorage
        // 保存後端數據
    function saveBackendData() {
      localStorage.setItem('backend_users', JSON.stringify(backendData.users));
      localStorage.setItem('backend_primary', JSON.stringify(backendData.studentData.primary));
      localStorage.setItem('backend_junior', JSON.stringify(backendData.studentData.junior));
      localStorage.setItem('backend_high', JSON.stringify(backendData.studentData.high));
      localStorage.setItem('backend_other', JSON.stringify(backendData.studentData.other));
      localStorage.setItem('backend_pending', JSON.stringify(backendData.pendingData));
      localStorage.setItem('announcements', JSON.stringify(backendData.announcements));
      localStorage.setItem('system_config', JSON.stringify(backendData.systemConfig));
      localStorage.setItem('friends_data', JSON.stringify(backendData.friends));
      localStorage.setItem('private_messages', JSON.stringify(backendData.privateMessages));
      localStorage.setItem('questions_data', JSON.stringify(backendData.questions));
      localStorage.setItem('chat_messages', JSON.stringify(backendData.chatMessages));
    }
      
      // 同時保存到 localStorage 作為備份
      localStorage.setItem('backend_users', JSON.stringify(backendData.users));
      localStorage.setItem('backend_primary', JSON.stringify(backendData.studentData.primary));
      localStorage.setItem('backend_junior', JSON.stringify(backendData.studentData.junior));
      localStorage.setItem('backend_high', JSON.stringify(backendData.studentData.high));
      localStorage.setItem('backend_other', JSON.stringify(backendData.studentData.other));
      localStorage.setItem('backend_pending', JSON.stringify(backendData.pendingData));
      localStorage.setItem('announcements', JSON.stringify(backendData.announcements));
      localStorage.setItem('system_config', JSON.stringify(backendData.systemConfig));
      localStorage.setItem('friends_data', JSON.stringify(backendData.friends));
      localStorage.setItem('private_messages', JSON.stringify(backendData.privateMessages));
      localStorage.setItem('questions_data', JSON.stringify(backendData.questions));
      localStorage.setItem('chat_messages', JSON.stringify(backendData.chatMessages));
    }

    // 初始化
        // 初始化
    document.addEventListener('DOMContentLoaded', function() {
      // 檢查是否有預設管理員帳號
      if (!backendData.users['Nick20130104']) {
        backendData.users['Nick20130104'] = {
          password: 'Nick20130104',
          name: '系統管理員',
          school: '管理學校',
          email: 'admin@system.com',
          isAdmin: true,
          intro: '我是系統管理員，負責管理畢業資料系統。',
          anonymous: '管理員',
          avatar: null,
          personality: '認真負責、細心嚴謹',
          hobbies: '系統管理、程式設計',
          likes: '解決問題、學習新技術'
        };
        saveBackendData();
      }

      // 初始化科目選擇
      initSubjectTags();
    });
      // 檢查是否有預設管理員帳號
      if (!backendData.users['Nick20130104']) {
        backendData.users['Nick20130104'] = {
          password: 'Nick20130104',
          name: '系統管理員',
          school: '管理學校',
          email: 'admin@system.com',
          isAdmin: true,
          intro: '我是系統管理員，負責管理畢業資料系統。',
          anonymous: '管理員',
          avatar: null,
          personality: '認真負責、細心嚴謹',
          hobbies: '系統管理、程式設計',
          likes: '解決問題、學習新技術'
        };
        saveBackendData();
      }

      // 初始化科目選擇
      initSubjectTags();
    });

    // 初始化科目標籤
    function initSubjectTags() {
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
      const tags = document.querySelectorAll('.subject-tag');
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
      tags.forEach(tag => {
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
        tag.addEventListener('click', function() {
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
          tags.forEach(t => t.classList.remove('selected'));
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
          this.classList.add('selected');
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
          document.getElementById('selected-subject').value = this.dataset.subject;
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
        });
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
      });
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
    }
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }

    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
    // 後端數據（從 API 獲取）
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }

    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
    // 從 API 加載數據
    // 模擬後端數據庫
    const backendData = {
      users: JSON.parse(localStorage.getItem('backend_users') || '{}'),
      studentData: {
        primary: JSON.parse(localStorage.getItem('backend_primary') || '[]'),
        junior: JSON.parse(localStorage.getItem('backend_junior') || '[]'),
        high: JSON.parse(localStorage.getItem('backend_high') || '[]'),
        other: JSON.parse(localStorage.getItem('backend_other') || '[]')
      },
      pendingData: JSON.parse(localStorage.getItem('backend_pending') || '[]'),
      announcements: JSON.parse(localStorage.getItem('announcements') || '[]'),
      systemConfig: JSON.parse(localStorage.getItem('system_config') || '{}'),
      friends: JSON.parse(localStorage.getItem('friends_data') || '{}'),
      privateMessages: JSON.parse(localStorage.getItem('private_messages') || '{}'),
      questions: JSON.parse(localStorage.getItem('questions_data') || '[]'),
      chatMessages: JSON.parse(localStorage.getItem('chat_messages') || '[]')
    };

    // 顯示註冊頁面
    function showRegister() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('register-screen').style.display = 'flex';
    }

    // 顯示管理員登入頁面
    function showAdminLogin() {
      document.getElementById('login-screen').style.display = 'none';
      document.getElementById('admin-login-screen').style.display = 'flex';
    }

    // 隱藏管理員登入頁面
    function hideAdminLogin() {
      document.getElementById('admin-login-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 隱藏註冊頁面
    function hideRegister() {
      document.getElementById('register-screen').style.display = 'none';
      document.getElementById('login-screen').style.display = 'flex';
    }

    // 登入功能
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const errorMsg = document.getElementById('error-msg');
      
      if (!username || !password) {
        errorMsg.textContent = '請輸入帳號和密碼';
        return;
      }
      
      const user = backendData.users[username];
      
      if (user && user.password === password) {
        currentUser = username;
        isAdmin = user.isAdmin || false;
        
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-screen').style.display = 'block';
        document.getElementById('current-user-name').textContent = user.name;
        
        if (isAdmin) {
          document.getElementById('admin-badge').style.display = 'inline-block';
          document.getElementById('admin-tools').style.display = 'block';
          document.getElementById('review-btn').style.display = 'block';
          document.getElementById('statistics-btn').style.display = 'block';
        }
        
        loadContent('dashboard');
        showNotification(`歡迎回來，${user.name}！`, 'success');
      } else {
        errorMsg.textContent = '帳號或密碼錯誤';
      }
    }
